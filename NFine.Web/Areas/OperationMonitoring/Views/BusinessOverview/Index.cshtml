@{
    ViewBag.Title = "经营概览";
    Layout = "~/Views/Shared/_Index.cshtml";
}
@*<script src="~/Content/js/jquery/jquery-2.1.1.min.js"></script>*@
<script src="~/Content/js/echarts/4.3/echarts.js"></script>
<script src="~/Content/js/pages/world.js"></script>
@*<script src="~/Content/js/echarts/echarts.min.js"></script>*@
<script src="~/Content/js/bootstrap/bootstrap.js"></script>
<link href="~/Content/js/bootstrap/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/js/pages/AdminLTE.css" rel="stylesheet" />
<link href="~/Content/js/pages/AdminLTE.min.css" rel="stylesheet" />
<style>
</style>
<script>
    window.onload = function () {
        loadOne1a();
        loadOne1b();
        loadTwo();
        gridList();
        loadThree();
        loadFour();
        loadFive();
    }
    function selectType(obj) {
        loadOne1a();
        loadOne1b();
    }
    function selectTypes(obj) {
        loadThree();
    }
    function loadOne1a() {
        var listName = new Array();
        var TotalCost = 0;
        var str =[];
        var keyValue = $('#Type_id option:selected').val();
        $.ajax({
            url: "/OperationMonitoring/BusinessOverview/GetDataTotalCycleCost",
            data: { keyValue: keyValue },
            dataType: "json",
            async: false,
            success: function (data) {
                $(data).each(function (index, item) {
                    if (index == 0) {
                        TotalCost = item.TotalCost;
                    }
                    listName.push(item.Name);
                    var str3 = new Object();
                    str3.name = item.Name;
                    str3.value = item.Cost;
                    str[index] = str3;

                })
            }
        });

        var myChart = echarts.init(document.getElementById('chart1a'));
        // 指定图表的配置项和数据
        var option = {
            title: {//标题组件
                text: '￥' + TotalCost + '万',
                top: '45%',
                left: '35%',
                textStyle: {
                    color: "#505050",
                    fontSize: 15,
                    fontFamily: 'KaiTi',
                }
            },
            tooltip: { //提示框组件
                trigger: 'item', //触发类型(饼状图片就是用这个)
                formatter: "{b} : ({c}%)"//"{a} <br/>{b} : {c} ({d}%)" //提示框浮层内容格式器
            },
            color: ['#FFFF99', '#CCCC66', '#00CC99', '#FF3333'],  //手动设置每个图例的颜色
            legend: {  //图例组件
                //right:100,  //图例组件离右边的距离
                orient: 'horizontal',  //布局  纵向布局 图例标记居文字的左边 vertical则反之
                width: 40,      //图行例组件的宽度,默认自适应
                x: 'left',   //图例显示在右边
                y: 'top',   //图例在垂直方向上面显示居中
                itemWidth: 10,  //图例标记的图形宽度
                itemHeight: 10, //图例标记的图形高度
                data: listName,//['物料', '外协', '自制', '异常'],
                textStyle: {    //图例文字的样式
                    color: '#333',  //文字颜色
                    fontSize: 12    //文字大小
                }
            },
            series: [ //系列列表
                {
                    //name:'设备状态',  //系列名称
                    type: 'pie',   //类型 pie表示饼图
                    center: ['50%', '50%'], //设置饼的原心坐标 不设置就会默认在中心的位置
                    radius: ['50%', '70%'],  //饼图的半径,第一项是内半径,第二项是外半径,内半径为0就是真的饼,不是环形
                    itemStyle: {  //图形样式
                        normal: { //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,  //平常不显示
                                formatter: '{c}%',
                                position: 'inner'
                            },
                            labelLine: {     //标签的视觉引导线样式
                                show: false  //平常不显示
                            }
                        },
                        emphasis: {   //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '20',
                                    fontWeight: 'bold'
                                }
                            }
                        }
                    },
                    data: str//[ { value: 27, name: '物料' }, { value: 18, name: '外协' }, { value: 53, name: '自制' }, { value: 2, name: '异常' } ]
                }
            ]
        };
        myChart.setOption(option);
    }
    function loadOne1b() {
        var listName = new Array();
        var str = [];
        var keyValue = $('#Type_id option:selected').val();
        $.ajax({
            url: "/OperationMonitoring/BusinessOverview/GetDataCostByDepartment",
            data: { keyValue: keyValue },
            dataType: "json",
            async: false,
            success: function (data) {
                $(data).each(function (index, item) {
                    listName.push(item.Name);
                    var str3 = new Object();
                    str3.name = item.Name;
                    str3.value = item.Cost;
                    str[index] = str3;

                })
            }
        });

        var myChart = echarts.init(document.getElementById('chart1b'));
        var option = {
            //title: {
            //    text: '某站点用户访问来源',
            //    subtext: '纯属虚构',
            //    left: 'center'
            //},
            tooltip: {
                trigger: 'item',
                formatter: "{b} : ({c}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                itemWidth: 10,  //图例标记的图形宽度
                itemHeight: 10, //图例标记的图形高度
                data: listName//['CNC', 'EDM', 'WEDM', '车铣磨抛']
            },
            color: ['#FFFF99', '#CCCC66', '#00CC99', '#FF3333'],
            series: [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius: '65%',
                    center: ['50%', '50%'],
                    data: str//[{ value: 23, name: 'CNC' },{ value: 26, name: 'EDM' },{ value: 17, name: 'WEDM' },{ value: 34, name: '车铣磨抛' },]
                    ,
                    itemStyle: {  //图形样式
                        normal: { //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,  //平常不显示
                                formatter: '{c}%',
                                position: 'inner'
                            },
                            labelLine: {     //标签的视觉引导线样式
                                show: false  //平常不显示
                            }
                        },
                        emphasis: {   //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '20',
                                    fontWeight: 'bold'
                                }
                            },
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    }
    function loadTwo() {
        var ListMonth = new Array();
        var ListDeliveryRate = new Array();

        $.ajax({
            async: false,
            url: "/OperationMonitoring/BusinessOverview/GetDataDeliveryCompletionRate",
            type: "get",
            dataType: "json",
            success: function (da) {
                $(da).each(function (index, item) {
                    ListMonth.push(item.Month);
                    ListDeliveryRate.push(item.DeliveryRate);
                })
            }
        })
        var myChart = echarts.init(document.getElementById('chart2'));
       
        var myColor = ['#45fda5', '#3ffd55', '#11da01', '#118b43', '#c3eb18', '#dfde14', '#eac736', '#ed5501', '#9d0700', '#e80c00'];

        var option = {
            backgroundColor: 'white',
            grid: {
                top: 10,
                left: 15,
                right: 15,
                bottom: 50,
                containLabel: true //轴上的数值
            },
            xAxis: {
                type: 'category',
                splitLine: false,
                boundaryGap: false,
                axisLine: {
                    show: false,
                    lineStyle: {
                        color: myColor[0]
                    }
                },
                axisTick: {
                    lineStyle: {
                        color: myColor[0]
                    }
                },
                axisPointer: {
                    label: {
                        formatter: function (params) {
                            return '交期达成率  ' + params.value + (params.seriesData.length ? '：' + params.seriesData[0].data : '') + '%';
                        }
                    }
                },
                data: ListMonth
            },
            yAxis: {
                //type: 'value',
                //min: 0,
                //splitLine: false,
                //axisLine: {
                //    show: false
                //},
                //axisTick: {
                //    show: false
                //},
                interval: 20,
                axisLabel: {
                    formatter: function (value) {
                        return value + "%";
                    },
                    textStyle: {
                        color: function (value) {
                            //注意：当值大于999(三位)时，会以“1,000”形式，所以要做以下处理
                            value = parseInt(value.replace(/,/g, ""));
                            var idx = parseInt(value / 10);
                            return myColor[idx > 9 ? 9 : idx];
                        }
                    }
                },
                type: 'value',
                //axisLabel: {
                //    show: true,
                //    interval: 'auto',
                //    formatter: '{value}%',
                //    textStyle: {
                //        color: myColor
                //    }
                //},
                show: true
            },
            visualMap: {
                show: false,
                calculable: true,
                min: 0,
                max: 100,
                inRange: {
                    color: myColor
                }
            },
                tooltip: {
                    trigger: 'none',
                    axisPointer: {
                        type: 'cross'
                    }
                },
            series: [{
                name: '交期达成率',
                type: 'line',
                //symbol: 'none', //这句就是去掉折线上的点的
                smooth: true, //这句就是让曲线变平滑的
                hoverAnimation: true,
                data: ListDeliveryRate,
                // 显示数值
                itemStyle: {
                    normal: {
                        label: {
                            show: true,
                            formatter: '{c}%',
                            position: 'bottom',
                            color: "#505050"
                        }
                    }
                }
            }]
        };

       myChart.setOption(option);
    }
    function gridList() {
        var $gridList = $("#gridList");
        $gridList.dataGrid({
            url: "/OperationMonitoring/BusinessOverview/GetGridJson",
            height: 70,
            colModel: [
                { label: '模具编号', name: 'MoldNo', width: 80, align: 'left' },
                { label: '试模', name: 'MoldTest', width: 60, align: 'left' },
                { label: '类型', name: 'Type', width: 60, align: 'left' },
                { label: '状态', name: 'State', width: 70, align: 'left' },
                { label: '产品名称', name: 'ProductName', width: 80, align: 'left' },
                {
                    label: '计划交期', name: 'PlannedDeliveryDate', width: 100, align: 'left',
                    formatter: "date", formatoptions: { srcformat: 'Y/m/d', newformat: 'Y/m/d' }
                },
                {
                    label: '预警', name: 'EarlyWarning', width: 120, align: 'left',
                    formatter: function (cellvalue, row, index) {
                        return '<div style="top: 0%;left: 50%; transform: translate(-0%, -50%);"> <div style="border: 1px #000000 solid;margin:0 auto;position: relative;width:80%; height: 5px;background-color: #f9e1e3; border-radius: 3px;"><div style="white-space: pre-line;width: ' + index.EarlyWarning + '%;height: 100%;background-color:' + index.EarlyWarningColor + ';border-radius: 3px;"></div></div></div>'
                    }
                },
            ],
            //pager: "#gridPager",
            sortname: 'MoldNo desc',
            viewrecords: true
        });
    }
    function loadThree()
    {
        var listDeviceType = new Array();
        var listDeviceName = new Array();
        var listAll = new Array();
        var keyValue = $('#Types_id option:selected').val();
        $.ajax({
            url: "/OperationMonitoring/BusinessOverview/GetDataBOCapacityLoad",
            data: { keyValue: keyValue },
            dataType: "json",
            async: false,
            success: function (da) {
                $(da).each(function (index, item) {
                    listDeviceType.push(item.DeviceType);
                    listDeviceName.push(item.DeviceName);
                    listAll.push(item);
                })
            }
        })

        $.unique(listDeviceType);
        $.unique(listDeviceName.sort());

        var series = [];
        $.each(listDeviceName, function (index, value) {
            var tempName = new Array();
            var tempArry = new Array();
            $.each(listAll, function (index1, value1) {
                if (value == value1.DeviceName) {
                    tempName = value1.DeviceName;
                    tempArry.push(value1.Number);
                }
            });
            series.push({
                name: tempName,
                type: tempName == "车铣刨磨" ? 'line' : 'bar',
                stack: '广告',
                data: tempArry
            })
        });

        var myChart = echarts.init(document.getElementById('chart3'));

        var option = {
            color: ['#6cce8f', '#e5323e', '#FFFF00'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    }
                },
                formatter: function (params) {
                    var relVal = params[0].name;
                    for (var i = 0, l = params.length; i < l; i++) {
                        relVal += '<br/>' + params[i].marker + params[i].seriesName + ' : ' + params[i].value + "%";
                    }
                    return relVal;
                }
            },
            toolbox: {
                show: true,
                orient: 'vertical',
                left: 'right',
                top: 'center',
                feature: {
                    mark: { show: true },
                    dataView: { show: true, readOnly: false },
                    magicType: { show: true, type: ['line', 'bar'] },
                    restore: { show: true },
                    saveAsImage: { show: true }
                }
            },
            legend: {
                data: listDeviceName
            },
            xAxis: [
                {
                    type: 'category',
                    data: listDeviceType,
                    axisPointer: {
                        type: 'shadow'
                    }
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        show: true,
                        interval: 'auto',
                        formatter: '{value} %'
                    },
                    show: true
                }
            ],
            series: series
            //series: [
            //    {
            //        name: '产能',
            //        type: 'bar',
            //        stack: '广告',
            //        data: [95,88, 50,30]
            //    },
            //    {
            //        name: '产能缺口',
            //        type: 'bar',
            //        stack: '广告',
            //        data: [22, 50, 0,0]
            //    },
            //    {
            //        name: '车铣刨磨',
            //        type: 'line',
            //        stack: '广告',
            //        data: [117,138, 30,25]
            //    }
            //]
        };
        myChart.setOption(option, true);
    }
    function loadFour()
    {
        var listName = new Array();
        var str = [];
        $.ajax({
            url: "/OperationMonitoring/BusinessOverview/GetDataKeyCustomers",
            dataType: "json",
            async: false,
            success: function (data) {
                $(data).each(function (index, item) {
                    listName.push(item.Name);
                    var str3 = new Object();
                    str3.name = item.Name;
                    str3.value = item.Number;
                    str[index] = str3;
                })
            }
        });
        var myChart1 = echarts.init(document.getElementById('chart4a'));
        var option1 = {
            //title: {
            //    text: '某站点用户访问来源',
            //    subtext: '纯属虚构',
            //    left: 'center'
            //},
            tooltip: {
                trigger: 'item',
                formatter: "{b} : ({c}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                itemWidth: 10,  //图例标记的图形宽度
                itemHeight: 10, //图例标记的图形高度
                data: listName
            },
            //color: ['#FFFF99', '#CCCC66', '#00CC99', '#FF3333'],
            series: [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius: '65%',
                    center: ['50%', '50%'],
                    data: str,
                    itemStyle: {  //图形样式
                        normal: { //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,  //平常不显示
                                formatter: '{c}%',
                                position: 'inner'
                            },
                            labelLine: {     //标签的视觉引导线样式
                                show: false  //平常不显示
                            }
                        },
                        emphasis: {   //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '20',
                                    fontWeight: 'bold'
                                }
                            },
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                }
            ]
        };
        myChart1.setOption(option1);
    }
    function loadFive()
    {
        var myChart = echarts.init(document.getElementById('chart4b'));
        option = {  
            title: {  
                sublink: 'http://esa.un.org/wpp/Excel-Data/population.htm',  
                left: 'center',  
                top: 'top'  
            },  
            tooltip: {  
                 trigger: 'item',  
                 formatter: function (params) {  
                     var value = (params.value + '').split('.');  
                     value = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,')  
                             + '.' + value[1];  
                     return params.seriesName + '<br/>' + params.name + ' : ' + value;  
                 }  
             },       
            visualMap: {  
                min: 0,  
                max: 1000000,  
                text:['High','Low'],  
                realtime: false,  
                calculable: true,  
                color: ['orangered','yellow','lightskyblue']  
            },  
            series: [  
                {  
                    name: ' Global distribution of customers（2020）',
                    type: 'map',  
                    mapType: 'world',  
                    roam: true,  
                    itemStyle:{  
                        emphasis:{label:{show:true}}  
                    },  
                    data: [  
                    {name: 'Afghanistan', value: 28397.812},  
                    {name: 'Angola', value: 19549.124},  
                    {name: 'Albania', value: 3150.143},  
                    {name: 'United Arab Emirates', value: 8441.537},  
                    {name: 'Argentina', value: 40374.224},  
                    {name: 'Armenia', value: 2963.496},  
                    {name: 'French Southern and Antarctic Lands', value: 268.065},  
                    {name: 'Australia', value: 22404.488},  
                    {name: 'Austria', value: 8401.924},  
                    {name: 'Azerbaijan', value: 9094.718},  
                    {name: 'Burundi', value: 9232.753},  
                    {name: 'Belgium', value: 10941.288},  
                    {name: 'Benin', value: 9509.798},  
                    {name: 'Burkina Faso', value: 15540.284},  
                    {name: 'Bangladesh', value: 151125.475},  
                    {name: 'Bulgaria', value: 7389.175},  
                    {name: 'The Bahamas', value: 66402.316},  
                    {name: 'Bosnia and Herzegovina', value: 3845.929},  
                    {name: 'Belarus', value: 9491.07},  
                    {name: 'Belize', value: 308.595},  
                    {name: 'Bermuda', value: 64.951},  
                    {name: 'Bolivia', value: 716.939},  
                    {name: 'Brazil', value: 195210.154},  
                    {name: 'Brunei', value: 27.223},  
                    {name: 'Bhutan', value: 716.939},  
                    {name: 'Botswana', value: 1969.341},  
                    {name: 'Central African Republic', value: 4349.921},  
                    {name: 'Canada', value: 34126.24},  
                    {name: 'Switzerland', value: 7830.534},  
                    {name: 'Chile', value: 17150.76},  
                    {name: 'China', value: 1359821.465},  
                    {name: 'Ivory Coast', value: 60508.978},  
                    {name: 'Cameroon', value: 20624.343},  
                    {name: 'Democratic Republic of the Congo', value: 62191.161},  
                    {name: 'Republic of the Congo', value: 3573.024},  
                    {name: 'Colombia', value: 46444.798},  
                    {name: 'Costa Rica', value: 4669.685},  
                    {name: 'Cuba', value: 11281.768},  
                    {name: 'Northern Cyprus', value: 1.468},  
                    {name: 'Cyprus', value: 1103.685},  
                    {name: 'Czech Republic', value: 10553.701},  
                    {name: 'Germany', value: 83017.404},  
                    {name: 'Djibouti', value: 834.036},  
                    {name: 'Denmark', value: 5550.959},  
                    {name: 'Dominican Republic', value: 10016.797},  
                    {name: 'Algeria', value: 37062.82},  
                    {name: 'Ecuador', value: 15001.072},  
                    {name: 'Egypt', value: 78075.705},  
                    {name: 'Eritrea', value: 5741.159},  
                    {name: 'Spain', value: 46182.038},  
                    {name: 'Estonia', value: 1298.533},  
                    {name: 'Ethiopia', value: 87095.281},  
                    {name: 'Finland', value: 5367.693},  
                    {name: 'Fiji', value: 860.559},  
                    {name: 'Falkland Islands', value: 49.581},  
                    {name: 'France', value: 63230.866},  
                    {name: 'Gabon', value: 1556.222},  
                    {name: 'United Kingdom', value: 62066.35},  
                    {name: 'Georgia', value: 4388.674},  
                    {name: 'Ghana', value: 24262.901},  
                    {name: 'Guinea', value: 10876.033},  
                    {name: 'Gambia', value: 1680.64},  
                    {name: 'Guinea Bissau', value: 10876.033},  
                    {name: 'Equatorial Guinea', value: 696.167},  
                    {name: 'Greece', value: 11109.999},  
                    {name: 'Greenland', value: 56.546},  
                    {name: 'Guatemala', value: 14341.576},  
                    {name: 'French Guiana', value: 231.169},  
                    {name: 'Guyana', value: 786.126},  
                    {name: 'Honduras', value: 7621.204},  
                    {name: 'Croatia', value: 4338.027},  
                    {name: 'Haiti', value: 9896.4},  
                    {name: 'Hungary', value: 10014.633},  
                    {name: 'Indonesia', value: 240676.485},  
                    {name: 'India', value: 1205624.648},  
                    {name: 'Ireland', value: 4467.561},  
                    {name: 'Iran', value: 240676.485},  
                    {name: 'Iraq', value: 30962.38},  
                    {name: 'Iceland', value: 318.042},  
                    {name: 'Israel', value: 7420.368},  
                    {name: 'Italy', value: 60508.978},  
                    {name: 'Jamaica', value: 2741.485},  
                    {name: 'Jordan', value: 6454.554},  
                    {name: 'Japan', value: 127352.833},  
                    {name: 'Kazakhstan', value: 15921.127},  
                    {name: 'Kenya', value: 40909.194},  
                    {name: 'Kyrgyzstan', value: 5334.223},  
                    {name: 'Cambodia', value: 14364.931},  
                    {name: 'South Korea', value: 51452.352},  
                    {name: 'Kosovo', value: 97.743},  
                    {name: 'Kuwait', value: 2991.58},  
                    {name: 'Laos', value: 6395.713},  
                    {name: 'Lebanon', value: 4341.092},  
                    {name: 'Liberia', value: 3957.99},  
                    {name: 'Libya', value: 6040.612},  
                    {name: 'Sri Lanka', value: 20758.779},  
                    {name: 'Lesotho', value: 2008.921},  
                    {name: 'Lithuania', value: 3068.457},  
                    {name: 'Luxembourg', value: 507.885},  
                    {name: 'Latvia', value: 2090.519},  
                    {name: 'Morocco', value: 31642.36},  
                    {name: 'Moldova', value: 103.619},  
                    {name: 'Madagascar', value: 21079.532},  
                    {name: 'Mexico', value: 117886.404},  
                    {name: 'Macedonia', value: 507.885},  
                    {name: 'Mali', value: 13985.961},  
                    {name: 'Myanmar', value: 51931.231},  
                    {name: 'Montenegro', value: 620.078},  
                    {name: 'Mongolia', value: 2712.738},  
                    {name: 'Mozambique', value: 23967.265},  
                    {name: 'Mauritania', value: 3609.42},  
                    {name: 'Malawi', value: 15013.694},  
                    {name: 'Malaysia', value: 28275.835},  
                    {name: 'Namibia', value: 2178.967},  
                    {name: 'New Caledonia', value: 246.379},  
                    {name: 'Niger', value: 15893.746},  
                    {name: 'Nigeria', value: 159707.78},  
                    {name: 'Nicaragua', value: 5822.209},  
                    {name: 'Netherlands', value: 16615.243},  
                    {name: 'Norway', value: 4891.251},  
                    {name: 'Nepal', value: 26846.016},  
                    {name: 'New Zealand', value: 4368.136},  
                    {name: 'Oman', value: 2802.768},  
                    {name: 'Pakistan', value: 173149.306},  
                    {name: 'Panama', value: 3678.128},  
                    {name: 'Peru', value: 29262.83},  
                    {name: 'Philippines', value: 93444.322},  
                    {name: 'Papua New Guinea', value: 6858.945},  
                    {name: 'Poland', value: 38198.754},  
                    {name: 'Puerto Rico', value: 3709.671},  
                    {name: 'North Korea', value: 1.468},  
                    {name: 'Portugal', value: 10589.792},  
                    {name: 'Paraguay', value: 6459.721},  
                    {name: 'Qatar', value: 1749.713},  
                    {name: 'Romania', value: 21861.476},  
                    {name: 'Russia', value: 21861.476},  
                    {name: 'Rwanda', value: 10836.732},  
                    {name: 'Western Sahara', value: 514.648},  
                    {name: 'Saudi Arabia', value: 27258.387},  
                    {name: 'Sudan', value: 35652.002},  
                    {name: 'South Sudan', value: 9940.929},  
                    {name: 'Senegal', value: 12950.564},  
                    {name: 'Solomon Islands', value: 526.447},  
                    {name: 'Sierra Leone', value: 5751.976},  
                    {name: 'El Salvador', value: 6218.195},  
                    {name: 'Somaliland', value: 9636.173},  
                    {name: 'Somalia', value: 9636.173},  
                    {name: 'Republic of Serbia', value: 3573.024},  
                    {name: 'Suriname', value: 524.96},  
                    {name: 'Slovakia', value: 5433.437},  
                    {name: 'Slovenia', value: 2054.232},  
                    {name: 'Sweden', value: 9382.297},  
                    {name: 'Swaziland', value: 1193.148},  
                    {name: 'Syria', value: 7830.534},  
                    {name: 'Chad', value: 11720.781},  
                    {name: 'Togo', value: 6306.014},  
                    {name: 'Thailand', value: 66402.316},  
                    {name: 'Tajikistan', value: 7627.326},  
                    {name: 'Turkmenistan', value: 5041.995},  
                    {name: 'East Timor', value: 10016.797},  
                    {name: 'Trinidad and Tobago', value: 1328.095},  
                    {name: 'Tunisia', value: 10631.83},  
                    {name: 'Turkey', value: 72137.546},  
                    {name: 'United Republic of Tanzania', value: 44973.33},  
                    {name: 'Uganda', value: 33987.213},  
                    {name: 'Ukraine', value: 46050.22},  
                    {name: 'Uruguay', value: 3371.982},  
                    {name: 'United States of America', value: 312247.116},  
                    {name: 'Uzbekistan', value: 27769.27},  
                    {name: 'Venezuela', value: 236.299},  
                    {name: 'Vietnam', value: 89047.397},  
                    {name: 'Vanuatu', value: 236.299},  
                    {name: 'West Bank', value: 13.565},  
                    {name: 'Yemen', value: 22763.008},  
                    {name: 'South Africa', value: 51452.352},  
                    {name: 'Zambia', value: 13216.985},  
                    {name: 'Zimbabwe', value: 13076.978}  
                    ] 
                }  
            ]  
        };  
        myChart.setOption(option);
    }
    function funOne()
    {
        window.open("/OperationMonitoring/BusinessOverview/Form1");
    } 
    function funTwo() {
        window.open("/OperationMonitoring/BusinessOverview/Form2");
    }
    function funThree()
    {
        window.open("/OperationMonitoring/BusinessOverview/Form3");
    }
    function funFour()
    {
        window.open("/OperationMonitoring/BusinessOverview/Form4");
    }
</script>

<body>
    <div class="row">
        <section class="col-lg-6 connectedSortable" style="width:50%">
            <div class="box box-default">
                <div class="box-header with-border">
                    <h4 class="box-title">生产成本</h4>
                    <select id="Type_id" name="Type" style="border: solid 1px #000;"  onchange="selectType(this)">
                        <option value="1" selected = "selected">一周</option>
                        <option value="2">两周</option>
                        <option value="3">三周</option>
                        <option value="4">一个月</option>
                        <option value="5">半年</option>
                        <option value="6">一年</option>
                    </select>
                    <div class="box-tools pull-right">
                        <button type="button" onclick="funOne()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                    </div>
                </div>
                <div class="tab-content" style="height:100%;">
                    <div style="float:left;width:50%">
                        <div  style="text-align:center;font-size:13px;">周期总生产成本</div>
                        <div id="chart1a" style="height:260px; "></div>
                    </div>
                    <div style="margin-left:50%;width:auto;">
                        <div style="text-align:center;font-size:13px;">自制成本按部门分类</div>
                        <div id="chart1b" style="height:260px; "></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="col-lg-6 connectedSortable" style="width:50%">
            <div class="box box-default">
                <div class="box-header with-border">
                    <h4 class="box-title">交付率/进度</h4>
                    <div class="box-tools pull-right">
                        <button type="button" onclick="funTwo()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                    </div>
                </div>
                <div class="tab-content" style="height:100%;">
                    <div style="height:145px">
                        <div style="text-align:center;font-size:13px;">交期达成率趋势</div>
                        <div id="chart2" style="height:155px;"></div>
                    </div>
                    <div class="gridPanel" style="height:90%;margin:10px;width:98%">
                        <table id="gridList"></table>
                        <div style="text-align:center;font-size:13px;">在制模具进度</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="col-lg-6 connectedSortable" style="width:35%">
            <div class="box box-default">
                <div class="box-header with-border">
                    <h4 class="box-title">产能/负载</h4>
                    <select id="Types_id" name="Types" style="border: solid 1px #000;" onchange="selectTypes(this)">
                        <option value="1" selected="selected">一周</option>
                        <option value="2">两周</option>
                        <option value="3">三周</option>
                        <option value="4">一个月</option>
                        <option value="5">半年</option>
                        <option value="6">一年</option>
                    </select>
                    <div class="box-tools pull-right">
                        <button type="button" onclick="funThree()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                    </div>
                </div>
                <div class="tab-content">
                    <div id="chart3" style="height:280px;"></div>
                </div>
            </div>
        </section>

        <section class="col-lg-6 connectedSortable" style="width:65%">
            <div class="box box-default">
                <div class="box-header with-border">
                    <h4 class="box-title">客户分布</h4>
                    <div class="box-tools pull-right">
                        <button type="button" onclick="funFour()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                    </div>
                </div>
                <div class="tab-content" style="height:100%;">
                    <div style="float:left;width:50%">
                        <div style="text-align:center;font-size:13px;">主要客户</div>
                        <div id="chart4a" style="height:263px; "></div>
                    </div>
                    <div style="margin-left:50%;width:auto;">
                        <div style="text-align:center;font-size:13px;">全球分布</div>
                        <div id="chart4b" style="height:263px; "></div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>